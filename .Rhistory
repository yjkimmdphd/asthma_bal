x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = NA,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = ifelse(res_nasal$log2FoldChange > 0 & res_nasal$padj < 0.05, 'red',
ifelse(res_nasal$log2FoldChange < 0 & res_nasal$padj < 0.05, 'blue', 'grey50')),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1.3
# padj are BH adjusted pvalues
p1<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
selectLab = rownames(res_nasal)[which(names(keyvals_n)%in%c('nasal_KDA_up','nasal_KDA_down','nasal_anhdo_kda_cilia','nasal_anhdo_kda_inf'))],
colAlpha = 0.4,
colCustom = keyvals_n,
legendLabels=c('Not sig.','Log (base 2) FC','p-value',
'p-adj (<0.05) & Log (base 2) FC'),
legendPosition = 'right',
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1
keyvals_n
nasal_genes
res_nasal
res_nasal%>%mutate(deg_sig=ifelse(padj<0.05|log2FoldChange>1,'cyan',
ifelse(padj<0.05|log2FoldChange<-1,'magenta',
'grey')))
res_nasal%>%mutate(deg_sig=ifelse(padj<0.05|log2FoldChange>1,'cyan',
ifelse(padj<0.05|log2FoldChange< -1,'magenta',
'grey')))
res_nasal<-res_nasal%>%mutate(deg_sig=ifelse(padj<0.05|log2FoldChange>1,'cyan',
ifelse(padj<0.05|log2FoldChange< -1,'magenta',
'grey')))
res_nasal$deg_sig%>%table()
res_nasal<-res_nasal%>%mutate(deg_sig=ifelse(padj<0.05&log2FoldChange>1,'cyan',
ifelse(padj<0.05&log2FoldChange< -1,'magenta',
'grey')))
res_nasal$deg_sig%>%table()
keyvals_n <- res_nasal$deg_sig
p1.3<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = NA,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1.3
res_nasal
p1.3<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = NA,
FCcutoff = NA,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1.3
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
selectLab = rownames(res_nasal)[which(names(keyvals_n)%in%c('nasal_KDA_up','nasal_KDA_down','nasal_anhdo_kda_cilia','nasal_anhdo_kda_inf'))],
colAlpha = 0.4,
colCustom = keyvals_n,
legendLabels=c('Not sig.','Log (base 2) FC','p-value',
'p-adj (<0.05) & Log (base 2) FC'),
legendPosition = 'right',
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
keyvals_n <- ifelse(
nasal_genes%in%nasal_kda_down_genes, 'royalblue',
ifelse(nasal_genes%in%nasal_kda_up_genes, 'gold',
'grey'))
keyvals_n[which(nasal_genes%in%anh_do_nasal_kda_cilia_module)]<-"cyan"
keyvals_n[which(nasal_genes%in%anh_do_nasal_kda_inf_module)]<-"magenta"
keyvals_n[is.na(keyvals_n)] <- 'grey'
names(keyvals_n)[keyvals_n == 'gold'] <- 'nasal_KDA_up'
names(keyvals_n)[keyvals_n == 'grey'] <- 'nasal_deg'
names(keyvals_n)[keyvals_n == 'royalblue'] <- 'nasal_KDA_down'
names(keyvals_n)[keyvals_n == 'cyan']<-'nasal_anhdo_kda_cilia'
names(keyvals_n)[keyvals_n == 'magenta']<-'nasal_anhdo_kda_inf'
keyvals_n
res_nasal<-res_nasal%>%mutate(deg_sig=ifelse(padj<0.05&log2FoldChange>1,'cyan',
ifelse(padj<0.05&log2FoldChange< -1,'magenta',
'grey')))
keyvals_n <- res_nasal$deg_sig
keyvals_n
length(keyvals_n)
dim(res_nasal)
keyvals_n <- ifelse(
nasal_genes%in%nasal_kda_down_genes, 'royalblue',
ifelse(nasal_genes%in%nasal_kda_up_genes, 'gold',
'grey'))
keyvals_n[which(nasal_genes%in%anh_do_nasal_kda_cilia_module)]<-"cyan"
keyvals_n[which(nasal_genes%in%anh_do_nasal_kda_inf_module)]<-"magenta"
keyvals_n[is.na(keyvals_n)] <- 'grey'
names(keyvals_n)[keyvals_n == 'gold'] <- 'nasal_KDA_up'
names(keyvals_n)[keyvals_n == 'grey'] <- 'nasal_deg'
names(keyvals_n)[keyvals_n == 'royalblue'] <- 'nasal_KDA_down'
names(keyvals_n)[keyvals_n == 'cyan']<-'nasal_anhdo_kda_cilia'
names(keyvals_n)[keyvals_n == 'magenta']<-'nasal_anhdo_kda_inf'
# padj are BH adjusted pvalues
p1<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
selectLab = rownames(res_nasal)[which(names(keyvals_n)%in%c('nasal_KDA_up','nasal_KDA_down','nasal_anhdo_kda_cilia','nasal_anhdo_kda_inf'))],
colAlpha = 0.4,
colCustom = keyvals_n,
legendLabels=c('Not sig.','Log (base 2) FC','p-value',
'p-adj (<0.05) & Log (base 2) FC'),
legendPosition = 'right',
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1
res_nasal<-res_nasal%>%mutate(deg_sig=ifelse(padj<0.05&log2FoldChange>1,'cyan',
ifelse(padj<0.05&log2FoldChange< -1,'magenta',
'grey')))
keyvals_n <- res_nasal$deg_sig
res_nasal
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = NA,
FCcutoff = NA,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
?EnhancedVolcano
p1.3<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1.3
class(keyvals_n)
p1.3<-EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
col=c("grey","cyan","magenta"),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
p1.3
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
col=c("grey","grey","cyan","magenta"),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
col=c("cyan","grey","grey","magenta"),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
col=c("grey","grey","grey","magenta"),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
col=c("grey","grey","grey","magenta","cyan"),
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
ifelse(res_nasal$padj<0.05&res_nasal$log2FoldChange>1,'cyan',
ifelse(res_nasal$padj<0.05&res_nasal$log2FoldChange< -1,'magenta',
'grey'))
keyvals_n <- ifelse(res_nasal$padj<0.05&res_nasal$log2FoldChange>1,'cyan',
ifelse(res_nasal$padj<0.05&res_nasal$log2FoldChange< -1,'magenta',
'grey'))
keyvals_n
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
length(keyvals_n)
dim(res_nasal)
res_nasal[,-"deg_sig"]
res_nasal[,-c("deg_sig")]
res_nasal
res_nasal[,-7]
res_nasal<-res_nasal[,-7]
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,8),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
#                      colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,3.5),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
#                      colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
names(keyvals_n)[keyvals_n== 'cyan'] <- 'up'
names(keyvals_n)[keyvals_n== 'magenta'] <- 'down'
names(keyvals_n)[keyvals_n == 'grey'] <- 'ns'
keyvals_n
keyvals_n%>%is.na
keyvals_n%>%is.na%>%sum
keyvals_n[is.na(keyvals_n)] <- 'black'
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,3.5),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
#                      colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
EnhancedVolcano(res_nasal,
lab = rownames(res_nasal),
title='Nasal DEG',
subtitle = '~ blood AEC + batch, p-adj (BH)',
x = 'log2FoldChange',
y = 'padj',
xlab = bquote(~Log[2]~ 'fold change'),
xlim=c(-10,8),
ylim=c(0,3.5),
pCutoff = 5e-2,
FCcutoff = 1,
cutoffLineType = 'twodash',
cutoffLineWidth = 0.8,
pointSize = 4.0,
labSize = 3,
colAlpha = 0.2,
colCustom = keyvals_n,
selectLab = NA,
legendLabSize = 10,
legendIconSize = 5.0,
drawConnectors = TRUE,
widthConnectors = 0.75)
